/* src/app/globals.css */

/* If stylelint is enabled, silence Tailwind at-rules warnings in this file. */
/* stylelint-disable at-rule-no-unknown */
/* @config "../tailwind.config.js" */

@tailwind base;
@tailwind components;
@tailwind utilities;

/* Respect system color-scheme for native widgets */
:root { color-scheme: light dark; }

/* Brand tokens */
:root {
  --brand-navy: #161748;
  --brand-green: #478559;
  --brand-blue: #39a0ca;

  /* RGB triplets for opacity-aware usage */
  --brand-navy-rgb: 22 23 72;
  --brand-green-rgb: 71 133 89;
  --brand-blue-rgb: 57 160 202;

  /* Z-index tokens (optional semantic mapping) */
  --z-header: 40;
  --z-backdrop: 45;
  --z-popover: 50;
  --z-drawer: 60;
  --z-toast: 70;
  --z-modal: 80;
}

/* Small utility */
.text-balance { text-wrap: balance; }

/* =========================
   Base layer
   ========================= */
@layer base {
  /* Smooth fonts */
  html {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Text selection color (uses rgb(var()) with color-mix) */
  ::selection {
    background: color-mix(in oklab, rgb(var(--brand-blue-rgb)) 18%, transparent);
    color: inherit;
  }

  /* Keep form controls readable in both themes */
  input, select, textarea, button {
    @apply text-gray-900 dark:text-slate-100;
  }
  input::placeholder,
  textarea::placeholder {
    @apply text-gray-500;
  }
  .dark input::placeholder,
  .dark textarea::placeholder {
    @apply text-slate-400;
  }

  /* Default control backgrounds (override per component as needed) */
  input, select, textarea {
    @apply bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-700;
  }

  /* Accessible focus */
  :focus-visible {
    outline: 0;
    box-shadow: 0 0 0 2px color-mix(in oklab, rgb(var(--brand-blue-rgb)) 80%, #fff 0%);
  }
  input:focus, select:focus, textarea:focus, button:focus {
    @apply outline-none ring-2 ring-brandBlue;
  }

  /* Reduced motion */
  @media (prefers-reduced-motion: reduce) {
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }

  /* Scrollbar (WebKit) */
  *::-webkit-scrollbar { width: 10px; height: 10px; }
  *::-webkit-scrollbar-thumb { background-color: rgba(0,0,0,.15); border-radius: 9999px; }
  .dark *::-webkit-scrollbar-thumb { background-color: rgba(255,255,255,.18); }
}

/* =========================
   Components layer
   ========================= */
@layer components {
  /* Translucent cards */
  .card-surface {
    @apply bg-white/80 dark:bg-white/5
           backdrop-blur-md
           text-gray-900 dark:text-slate-100
           border border-black/5 dark:border-white/10
           rounded-2xl shadow-sm;
  }

  .hero-surface {
    @apply bg-white/70 dark:bg-white/5
           backdrop-blur-md
           text-gray-900 dark:text-slate-100
           border border-black/5 dark:border-white/10
           rounded-2xl shadow
           p-6 md:p-8;
  }

  /* Solid card */
  .card {
    @apply bg-white dark:bg-slate-900/40
           text-gray-900 dark:text-slate-100
           border border-gray-200 dark:border-slate-800
           rounded-2xl shadow-sm;
  }

  /* Container wrapper (piggyback Tailwind container) */
  .container-page { @apply container max-w-6xl; }

  /* Inputs */
  .input {
    @apply w-full rounded-lg px-3 py-2
           bg-white dark:bg-slate-800
           border border-gray-300 dark:border-slate-700
           placeholder:text-gray-500 dark:placeholder:text-slate-400
           focus:outline-none focus:ring-2 focus:ring-brandBlue;
  }
  .select {
    @apply w-full rounded-lg px-3 py-2
           bg-white dark:bg-slate-800
           border border-gray-300 dark:border-slate-700
           focus:outline-none focus:ring-2 focus:ring-brandBlue;
  }
  .textarea {
    @apply w-full rounded-lg px-3 py-2
           bg-white dark:bg-slate-800
           border border-gray-300 dark:border-slate-700
           placeholder:text-gray-500 dark:placeholder:text-slate-400
           focus:outline-none focus:ring-2 focus:ring-brandBlue;
  }
  .label { @apply block text-sm font-medium text-gray-700 dark:text-slate-200 mb-1; }

  /* Buttons */
  .btn-outline {
    @apply inline-flex items-center justify-center gap-2
           rounded-xl px-4 py-2 font-semibold
           bg-white dark:bg-slate-800
           text-gray-900 dark:text-slate-100
           border border-gray-300 dark:border-slate-700
           hover:bg-gray-50 dark:hover:bg-slate-700
           focus:outline-none focus:ring-2 focus:ring-brandBlue focus:ring-offset-2 dark:focus:ring-offset-slate-900
           disabled:opacity-60 disabled:cursor-not-allowed;
  }

  .btn-danger {
    @apply inline-flex items-center justify-center gap-2
           rounded-lg px-3 py-1.5 text-sm
           text-white bg-red-600 hover:bg-red-700
           focus:outline-none focus:ring-2 focus:ring-red-400
           disabled:opacity-60 disabled:cursor-not-allowed;
  }

  /* Badges */
  .badge {
    @apply inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-xs
           bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700;
  }
  .badge-verified { @apply inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-xs bg-brandNavy text-white; }

  /* Skeleton */
  .skeleton {
    @apply animate-pulse bg-gray-200/70 dark:bg-slate-700/40;
    background-image: linear-gradient(90deg, transparent, rgba(255,255,255,.35), transparent);
    background-size: 200% 100%;
    background-position: 200% 0;
  }

  .shadow-soft { box-shadow: 0 10px 30px -10px rgba(0,0,0,0.25); }

  .link { @apply text-brandNavy hover:text-brandPink; }

  kbd {
    @apply inline-flex items-center rounded-md border px-1.5 py-0.5 text-[11px]
           bg-gray-50 dark:bg-slate-800 border-gray-200 dark:border-slate-700
           font-medium text-gray-700 dark:text-slate-200;
  }
}

/* =========================
   Utilities layer
   ========================= */
@layer utilities {
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    line-clamp: 2;
    overflow: hidden;
  }

  .break-anywhere { overflow-wrap: anywhere; word-break: break-word; }

  /* Prose tweaks (if @tailwind/typography is present) */
  .prose :where(code):not(:where([class~="not-prose"] *)) {
    @apply rounded-md bg-gray-100 dark:bg-slate-800 px-1.5 py-0.5 text-[0.85em];
  }

  /* Optional shimmer variant for skeletons */
  @keyframes skeleton-shimmer {
    0%   { background-position: 200% 0; }
    100% { background-position: -200% 0; }
  }
  .skeleton-shimmer {
    background-image: linear-gradient(90deg, transparent, rgba(255,255,255,.35), transparent);
    background-size: 200% 100%;
    animation: skeleton-shimmer 1.2s linear infinite;
  }

  /* --------- Optional semantic z-index helpers (if you prefer CSS names) --------- */
  .z-header   { z-index: var(--z-header); }
  .z-backdrop { z-index: var(--z-backdrop); }
  .z-popover  { z-index: var(--z-popover); }
  .z-drawer   { z-index: var(--z-drawer); }
  .z-toast    { z-index: var(--z-toast); }
  .z-modal    { z-index: var(--z-modal); }
}

/* stylelint-enable at-rule-no-unknown */
